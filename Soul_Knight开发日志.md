# **Soul_Knight开发日志**

- 3.28   导入素材（素材很多，导入就用了40多分钟），下载元气骑士试玩

- 3.29   继续浏览素材，发现素材太多，将导入素材删掉，导入关键素材，如人物、敌人动画，武器、子弹、场景物体等，利用TileMap初步建好第一关地图

  实现的功能

  （1）导入人物idle和run状态的动画，实现WASD移动和动画切换

  （2）实现鼠标移动控制枪口方向

  （3）实现摄像机跟随主角移动，用到Cinemachine插件

  

- 3.30  

  实现的功能

  （1）创建了一系列ScriptableObject数据文件，包括CharacterData_SO，PlayerData_SO（继承CharacterData_SO)，包含人物的各项数据，如血量、防御、能量、攻击力、冷却时间等等

  （2）创建人物左上角信息BarUI，血量、防御、能量三项滑动条与文字实时更新

  （3）创建第一个怪物--普通哥布林，实现基本AI,可以跟随player，用到了PathFinding包

  

- 3.31  今天课比较多，有点摸鱼，不过也在做比较难的一部分

  实现的功能

  （1）完善各项数据，进一步对各个人物、数据进行链接

  （2）实现左键开火，对象池生成子弹，子弹撞击敌人或障碍物隐藏

  

- 4.1

  实现的功能

  （1）进一步完善打怪系统，完成了子弹撞击敌人产生伤害，伤害文字会实时显示在头顶，普攻文字为黄色，暴击文字为红色。血量为0时死亡，敌人有追逐，站岗，死亡三种状态的切换

  （2）怪物也可以自动攻击玩家，血量数值和左上角信息栏滑动条同步变化，玩家血量为0后也会死亡，无法移动，怪物也不会再攻击，站在原地。

​           这个过程会调用许许多多的组件和变量，也出现了很多bug，不过这些bug都是小问题，我也一个个解决了  已知的bug，主要bug、问题以及解决方法如下：

​	      1、文字是属于UI部分，是屏幕坐标，要定位在人物头上并且实时跟踪，显示几秒后消失。  解决方法：人物	头上坐标是世界坐标，因此可以用mainCamera.WorldPointToScreenPoint函数将人物头上的坐标转化为屏幕	坐标再赋值给UI文字的坐标，将这个写成一个方法，用InvokeRepeating函数每0.02s调用一次，并写一个协                       程，等待2秒之后就将文字隐藏，并且用CancelInvoke取消Invoke方法调用。 

​          2、怪物或人物死后还能被继续攻击并且头顶有伤害文字。  解决方法:死亡后将碰撞体enabled=false，这样     子弹上的触发器就检测不到碰撞体了

​          3、怪物或人物死亡后还能移动，武器会继续旋转，也可以发炮。  解决方法：死亡后将AIPath组件中的maxSpeed调成0，人物rb.velocity=0。武器隐藏，在很多活动状态下执行的函数都加上判断，isDead==false才执行



- 4.2

  实现的功能

  （1）改变了攻击伤害方式：先减少盾牌数量，减少到0再开始减少生命值。另外每种武器有一个子弹能量消耗值，打一下就会消耗一定能量。

  （2）实现右键技能，人物会冒火，手上有两把枪，生成双倍子弹，冷却时间缩短且不耗能量，左上角有技能的闪电滑动条显示。

  （3）实现破坏的宝箱。敌人清除后会生成一个宝箱，人物靠近后宝箱会平滑打开。

  （4）添加了简单的UI界面：设置菜单，主菜单，加载面板等

  

- 4.3

  实现的功能

  （1）增加了哥布林祭祀和野猪两个怪物，增添了几把武器

  （2）增加近战武器类型，野猪使用近战武器实现蛮猪冲撞

  （3）优化生成宝箱方式，之前是用enemyCount来记录，敌人死亡GameManager.Instance.enemyCount--，但这样做容易出bug可能会多减一两次（为什么多减一两次我也不太确定，可能没来的及反应，很多类似的过程也会多调用一两次，这种情况就要利用判空避免bug），因此我采用了列表的方法，死亡后先判定列表中是否有该敌人，再从列表中移除，直到列表enemies.Count==0生成宝箱，保证不出bug

  （4）实现主副手武器，滑动鼠标滚轮可以切换主副武器









